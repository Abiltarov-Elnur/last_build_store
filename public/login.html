<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–í—Ö–æ–¥</title>
</head>
<body>
  <h1>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h1>
  <form id="loginForm">
    <input type="email" id="email" placeholder="Email" required />
    <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å" required />
    <button type="submit">–í–æ–π—Ç–∏</button>
  </form>
  <script>
    document.getElementById('loginForm').addEventListener('submit', async (e) => {
      e.preventDefault();
  
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
  
      try {
        const res = await fetch('/api/auth/login', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ email, password })
        });
  
        const data = await res.json();
  
        if (!res.ok) {
          alert(data.error || '–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞');
          return;
        }
  
        // üëá –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫—Ç–æ —Ç—ã
        alert(`–í—ã –≤–æ—à–ª–∏ –∫–∞–∫: ${data.role}`);
  
        // üëá –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ —Ä–æ–ª—è–º
        if (data.role === 'admin') {
          window.location.href = '/admin.html';
        } else if (data.role === 'seller') {
          window.location.href = '/seller-panel.html';
        } else if (data.role === 'client') {
          window.location.href = '/catalog.html';
        } else {
          alert('–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è —Ä–æ–ª—å');
        }
  
      } catch (err) {
        console.error(err);
        alert('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
      }
    });
  </script>
  
</body>
</html>
